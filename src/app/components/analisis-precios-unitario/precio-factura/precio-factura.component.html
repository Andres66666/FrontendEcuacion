<div class="d-flex gap-0">
  <div id="contentToExport" class="flex-grow-1 mb-3 p-3 rounded-3">
    <h2 class="mb-2 text-primary text-center text-uppercase">
      REPORTE FINANCIERO
    </h2>

    <div class="mb-3 text-uppercase fs-3">
      <div class="row justify-content-center">
        <div class="col-12 col-md-10">
          <!-- Proyecto -->
          <div
            class="mb-1 d-flex justify-content-center justify-content-md-start"
          >
            <div class="fw-semibold fw-bold" style="width: 160px">
              Proyecto:
            </div>
            <div class="fw-semibold">
              {{ nombreProyecto }}
            </div>
          </div>

          <!-- Ítem -->
          <div
            *ngIf="origen === 'ITEM'"
            class="mb-1 d-flex justify-content-center justify-content-md-start"
          >
            <div class="fw-semibold fw-bold" style="width: 160px">Ítem:</div>
            <div class="fw-semibold">
              {{ descripcionItem }}
            </div>
          </div>

          <!-- Módulo -->
          <div
            *ngIf="origen === 'MODULO'"
            class="mb-1 d-flex justify-content-center justify-content-md-start"
          >
            <div class="fw-semibold fw-bold" style="width: 160px">Módulo:</div>
            <div class="fw-semibold">
              {{ nombreModulo }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="pdf-page-section" id="page1-content">
      <!-- 1.- GASTOS DE OPERACIÓN Y COSTO DE VENTA -->
      <h3 class="section-title">1.- GASTOS DE OPERACIÓN Y COSTO DE VENTA</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-primary text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>MONTO (Bs)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>GASTOS DE OPERACIÓN</td>
              <td class="text-end">
                {{ formatearNumero(REPORTE_GASTOS_DE_OPERACION) }}
              </td>
            </tr>
            <tr>
              <td>
                CREDITO FISCAL IVA TASA NOMINAL: ({{
                  formatearNumero(iva_tasa_nominal)
                }}
                %)
              </td>
              <td class="text-end">-{{ formatearNumero(creditoFiscal) }}</td>
            </tr>
            <tr class="fw-bold">
              <td>COSTO DE VENTA</td>
              <td class="text-end fw-bold">
                {{ formatearNumero(costoVenta) }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 2.- VALOR AGREGADO  -->
      <h3 class="section-title">2.- VALOR AGREGADO</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-warning text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>MONTO (Bs)</th>
            </tr>
          </thead>
          <tbody>
            <tr class="fw-bold text-danger">
              <td>VALOR AGREGADO</td>
              <td class="text-end">
                {{ formatearNumero(REPORTE_VALOR_AGREGADO) }}
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 3.- PRECIO FACTURA - METODO MALLA FINITA -->
      <h3 class="section-title">3.- PRECIO FACTURA - METODO MALLA FINITA</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-success text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>MONTO (Bs)</th>
              <th>%</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>GASTOS DE OPERACIÓN</td>
              <td class="text-end">{{ formatearNumero(GastoOperacion3) }}</td>
              <td class="text-end">
                {{ formatearNumero(GastoOperacion31) }} %
              </td>
            </tr>
            <tr>
              <td>VALOR AGREGADO</td>
              <td class="text-end">{{ formatearNumero(ValorAgregado3) }}</td>
              <td class="text-end">{{ formatearNumero(ValorAgregado31) }} %</td>
            </tr>
            <tr class="fw-bold text-danger">
              <td>PRECIO FACTURA</td>
              <td class="text-end">{{ formatearNumero(precioFactura3) }}</td>
              <td class="text-end">{{ formatearNumero(precioFactura31) }} %</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 4.- FISCALIZACION POR IMPUESTOS INTERNOS -->
      <h3 class="section-title">4.- FISCALIZACION POR IMPUESTOS INTERNOS</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-secondary text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>MONTO (Bs)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>COSTO DE VENTA</td>
              <td class="text-end">{{ formatearNumero(costoVenta4) }}</td>
            </tr>
            <tr>
              <td>MARGEN DE UTILIDAD</td>
              <td class="text-end">{{ formatearNumero(margenUtilidad) }}</td>
            </tr>
            <tr>
              <td>
                IVA {{ formatearNumero(iva_tasa_nominal) }} % DE PRECIO FACTURA
              </td>
              <td class="text-end">{{ formatearNumero(iva13) }}</td>
            </tr>
            <tr class="fw-bold">
              <td class="text-end">PRECIO FACTURA</td>
              <td class="text-end">{{ formatearNumero(precioFactura3) }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 5.- ESTADO DE RESULTADOS -->
      <h3 class="section-title">5.- ESTADO DE RESULTADOS</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-success text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>MONTO (Bs)</th>
            </tr>
          </thead>
          <tbody>
            <tr class="fw-bold">
              <td>PRECIO FACTURA</td>
              <td class="text-end">{{ formatearNumero(precioFactura3) }}</td>
            </tr>
            <tr>
              <td>GASTOS DE OPERACIÓN</td>
              <td class="text-end">-{{ formatearNumero(GastoOperacion3) }}</td>
            </tr>
            <tr class="fw-bold text-danger">
              <td>VALOR AGREGADO</td>
              <td class="text-end">{{ formatearNumero(ValorAgregado3) }}</td>
            </tr>
            <tr>
              <td>IMPUESTO IVA {{ formatearNumero(iva_tasa_nominal) }}%</td>
              <td class="text-end">{{ formatearNumero(impuestoIva5) }}</td>
            </tr>
            <tr>
              <td>IT {{ formatearNumero(it) }} % DE LA FACTURA</td>
              <td class="text-end">{{ formatearNumero(itefactura5) }}</td>
            </tr>
            <tr>
              <td>IUE {{ formatearNumero(iue) }} % UTILIDAD</td>
              <td class="text-end">{{ formatearNumero(iueUtilidad5) }}</td>
            </tr>
            <tr class="fw-bold text-danger">
              <td>TOTAL IMPUESTOS</td>
              <td class="text-end">{{ formatearNumero(totalImpuestos5) }}</td>
            </tr>
            <tr class="fw-bold text-danger">
              <td>TOTAL UTILIDAD NETA</td>
              <td class="text-end">{{ formatearNumero(totalUtilidadNeta) }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 6.- METODOLOGIA LA GANANCIA ES PRIMERO -->
      <h3 class="section-title">6.- METODOLOGIA LA GANANCIA ES PRIMERO</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-danger text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>GANANCIAS NETAS</th>
              <th>% DE DISTRIBUCION META</th>
              <th>IDEAL</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>GANANCIA {{ formatearNumero(ganancia) }} %</td>
              <td class="text-end">{{ formatearNumero3(ganaciaColumna1) }}</td>
              <td class="text-end">
                {{ formatearNumero(gananciaColumna2) }} %
              </td>
              <td class="text-center">10%</td>
            </tr>
            <tr>
              <td>COMPENSACION DEL DUEÑO</td>
              <td class="text-end">
                {{ formatearNumero3(CompensacioDuenoColumna1) }}
              </td>
              <td class="text-end">
                {{ formatearNumero(CompensacioDuenoColumna2) }} %
              </td>
              <td class="text-center">10%</td>
            </tr>
            <tr>
              <td>IMPUESTOS</td>
              <td class="text-end">{{ formatearNumero(ImpuestosColumna1) }}</td>
              <td class="text-end">
                {{ formatearNumero(ImpuestosColumna2) }} %
              </td>
              <td class="text-center">15%</td>
            </tr>
            <tr>
              <td>GASTOS DE OPERACIÓN</td>
              <td class="text-end">
                {{ formatearNumero(GastosOperacionColumna1) }}
              </td>
              <td class="text-end">
                {{ formatearNumero(GastosOperacionColumna2) }} %
              </td>
              <td class="text-center">65%</td>
            </tr>
            <tr class="fw-bold">
              <td>PRECIO FACTURA</td>
              <td class="text-end">
                {{ formatearNumero(PrecioFacturaColumna1) }}
              </td>
              <td class="text-end">
                {{ formatearNumero(PrecioFacturaColumna2) }} %
              </td>
              <td class="text-center">100%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 7.- RENTABILIDAD -->
      <h3 class="section-title">7.- RENTABILIDAD</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-warning text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>MONTO (Bs)</th>
            </tr>
          </thead>
          <tbody>
            <tr class="fw-bold text-danger">
              <td>RENTABILIDAD (PROYECTO)</td>
              <td class="text-end">
                {{ formatearNumero(RentabilidadProyecto7) }} %
              </td>
            </tr>
            <tr>
              <td>RENTABILIDAD (GANANCIA)</td>
              <td class="text-end">
                {{ formatearNumero(RentabilidadGanacia7) }} %
              </td>
            </tr>
            <tr>
              <td>RENTABILIDAD (COMPENSACIÓN DEL DUEÑO)</td>
              <td class="text-end">
                {{ formatearNumero(RentabilidadCompensacionDuenio) }} %
              </td>
            </tr>
            <tr>
              <td>RENTABILIDAD (IMPUESTOS)</td>
              <td class="text-end">
                {{ formatearNumero(RentabilidadImpuestos) }} %
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 8.- RETORNO DE GASTOS DE OPERACIÓN -->
      <h3 class="section-title">8.- RETORNO DE GASTOS DE OPERACIÓN</h3>
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-3">
          <thead class="table-info text-white text-center">
            <tr>
              <th>DESCRIPCION</th>
              <th>NUMERO DE TRANSACCIONES</th>
            </tr>
          </thead>
          <tbody>
            <tr class="fw-bold text-danger">
              <td>RETORNO</td>
              <td class="text-end">{{ formatearNumero(RetornoInversion8) }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Botones laterales -->
  <div
    class="position-sticky top-50 translate-middle-y align-self-start z-3 d-flex flex-column align-items-center gap-3"
    style="width: 80px"
  >
    <a
      class="btn btn-primary btn-lg rounded-circle d-flex align-items-center justify-content-center"
      (click)="navigateToHome()"
      title="Volver al Panel"
    >
      <i class="bi bi-house-door-fill fs-2"></i>
    </a>

    <a
      class="btn btn-danger btn-lg rounded-circle d-flex align-items-center justify-content-center"
      (click)="generarReportePDF()"
      title="Generar Reporte PDF"
    >
      <i class="bi bi-file-earmark-pdf-fill fs-2"></i>
    </a>
  </div>
</div>
